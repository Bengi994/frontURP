(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[296],{7043:function(__unused_webpack_module,__unused_webpack_exports,__webpack_require__){(window.__NEXT_P=window.__NEXT_P||[]).push(["/solicitudes/solicitar-conferencia",function(){return __webpack_require__(4654)}])},8114:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{r:function(){return useCatalog}});var _utils_api__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2400);let useCatalog=()=>{let createCatalog=async(catalog,studentInfo)=>{let{data:{data:dataRaw}}=await _utils_api__WEBPACK_IMPORTED_MODULE_0__.h.post("/catologos",{data:catalog});return{...dataRaw.attributes,id:dataRaw.id}},getCatalogId=async catalogId=>{let response=await _utils_api__WEBPACK_IMPORTED_MODULE_0__.h.get("/catologos/".concat(catalogId)),catalogData=response.data.data.attributes;return catalogData},updateCatalog=async(catalogId,updatedCatalog)=>{let response=await _utils_api__WEBPACK_IMPORTED_MODULE_0__.h.put("/catologos/".concat(catalogId),{data:updatedCatalog});return 200===response.status?updatedCatalog:null},uploadPhoto=async(files,refId)=>{let formData=new FormData;formData.append("files",files),formData.append("ref","api::catologo.catologo"),formData.append("refId",refId),formData.append("field","foto");let response=await _utils_api__WEBPACK_IMPORTED_MODULE_0__.h.post("/upload",formData,{headers:{"content-type":"multipart/form-data"}});return 200===response.status};return{createCatalog,uploadPhoto,updateCatalog,getCatalogId}}},9086:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{$:function(){return useCatalogs}});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7294),_utils_api__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2400);let useCatalogs=()=>{let[catalogs,setCatalogs]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)([]),[SalonConferencia,setSalonConferencia]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)([]),getSalonNombre=salonId=>{let salon=SalonConferencia.find(salon=>salon.id===salonId);return salon?salon.attributes.nombre:""},getCatalogs=async()=>{let{data:{data:dataRaw}}=await _utils_api__WEBPACK_IMPORTED_MODULE_1__.h.get("/catologos?populate=*"),catalogsMapping=dataRaw.map(param=>{let{id,attributes}=param;return{...attributes,id}});setCatalogs(catalogsMapping)},removeCatalog=async catalogId=>{await _utils_api__WEBPACK_IMPORTED_MODULE_1__.h.put("/catologos/".concat(catalogId),{data:{disponible:!1,miconf:!1}}),await getCatalogs()},enabledCatalog=async catalogId=>{await _utils_api__WEBPACK_IMPORTED_MODULE_1__.h.put("/catologos/".concat(catalogId),{data:{disponible:!0,miconf:!1}}),await getCatalogs()},myCatalog=async catalogId=>{await _utils_api__WEBPACK_IMPORTED_MODULE_1__.h.put("/catologos/".concat(catalogId),{data:{disponible:!0,miconf:!0}}),await getCatalogs()},getCatalogId=async catalogId=>{let response=await _utils_api__WEBPACK_IMPORTED_MODULE_1__.h.get("/catologos/".concat(catalogId)),catalogData=response.data.data.attributes;return catalogData};return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{getCatalogs()},[]),{catalogs,removeCatalog,enabledCatalog,myCatalog,getCatalogId,getSalonNombre}}},4654:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:function(){return solicitar_conferencia}});var jsx_runtime=__webpack_require__(5893),ResponsivePage=__webpack_require__(8776),Form=__webpack_require__(1676),Button=__webpack_require__(5005),index_esm=__webpack_require__(7536),react=__webpack_require__(7294),useCatalog=__webpack_require__(8114),useCatalogs=__webpack_require__(9086),next_router=__webpack_require__(1163),react_datepicker_min=__webpack_require__(9198),react_datepicker_min_default=__webpack_require__.n(react_datepicker_min);__webpack_require__(5828);var api=__webpack_require__(2400);let useSalonConferencia=()=>{let[SalonConferencia,setSalonConferencia]=(0,react.useState)([]),getSalonConferencia=async()=>{let{data}=await api.h.get("/salons");Array.isArray(data.data)?setSalonConferencia(data.data):console.error("Los datos obtenidos no son un array:",data)};return{SalonConferencia,getSalonConferencia}},NewCatalog=()=>{let{register,handleSubmit,formState:{errors},setValue}=(0,index_esm.cI)(),[isAvailable,setIsAvailable]=(0,react.useState)(!1),[showModal,setShowModal]=(0,react.useState)(!1),{createCatalog}=(0,useCatalog.r)(),{catalogs}=(0,useCatalogs.$)(),router=(0,next_router.useRouter)(),[selectedDate,setSelectedDate]=(0,react.useState)(new Date),[salonId,setSalonId]=(0,react.useState)(0),[errorMessage,setErrorMessage]=(0,react.useState)(null),{SalonConferencia,getSalonConferencia}=useSalonConferencia(),handleOnSubmit=async data=>{try{let catalog={...data,fecha:selectedDate},response=await createCatalog(catalog);response&&await router.push("/solicitudes")}catch(error){error.response&&400===error.response.status?(setErrorMessage(error.response.data.message),console.log("Mensaje de error:",error.response.data.message)):console.error("Error desconocido:",error)}},diasNoHabiles=(0,react.useMemo)(()=>{let dias=catalogs.reduce((acc,catalogs)=>{var ref,ref1;let salonId=null==catalogs?void 0:null===(ref=catalogs.salon)||void 0===ref?void 0:null===(ref1=ref.data)||void 0===ref1?void 0:ref1.id,fecha=new Date(new Date(catalogs.fecha).toLocaleString("en",{timeZone:"UTC"}));return acc[salonId]?(acc[salonId]=acc[salonId].concat(fecha),acc):(acc[salonId]=[fecha],acc)},{});return console.log(dias),dias},[catalogs]);return(0,react.useEffect)(()=>{let fetchData=async()=>{try{await getSalonConferencia()}catch(error){console.error("Error al obtener los datos:",error)}};fetchData()},[]),console.log(SalonConferencia),Array.isArray(SalonConferencia)&&SalonConferencia.length>0&&console.log("Primer elemento:",SalonConferencia[0]),(0,jsx_runtime.jsx)(ResponsivePage.Y,{children:(0,jsx_runtime.jsxs)("div",{className:"container mt-3",children:[(0,jsx_runtime.jsx)("div",{className:"d-flex justify-content-between",children:(0,jsx_runtime.jsx)("h1",{className:"mb-2",children:"Nueva solicitud"})}),(0,jsx_runtime.jsx)("hr",{}),(0,jsx_runtime.jsxs)("div",{className:"",children:[errorMessage&&(0,jsx_runtime.jsx)("div",{className:"alert alert-danger",role:"alert",children:errorMessage}),(0,jsx_runtime.jsxs)(Form.Z,{className:"envio-solicitud-form",onSubmit:handleSubmit(handleOnSubmit),children:[(0,jsx_runtime.jsxs)(Form.Z.Group,{className:"form-group mb-3",children:[(0,jsx_runtime.jsx)(Form.Z.Label,{children:"Tema de la conferencia"}),(0,jsx_runtime.jsx)(Form.Z.Control,{type:"text",...register("tema_conferencia",{required:"Estecampo es requerido"})}),errors.tema_conferencia&&(0,jsx_runtime.jsx)(Form.Z.Text,{className:"text-danger",children:errors.tema_conferencia.message})]}),(0,jsx_runtime.jsxs)(Form.Z.Group,{className:"form-group mb-3",children:[(0,jsx_runtime.jsx)(Form.Z.Label,{children:"Descripcion"}),(0,jsx_runtime.jsx)(Form.Z.Control,{type:"text",...register("descripcion",{required:"Estecampo es requerido"})}),errors.descripcion&&(0,jsx_runtime.jsx)(Form.Z.Text,{className:"text-danger",children:errors.descripcion.message})]}),(0,jsx_runtime.jsxs)(Form.Z.Group,{className:"form-group mb-3",children:[(0,jsx_runtime.jsx)(Form.Z.Label,{children:"Expositor"}),(0,jsx_runtime.jsx)(Form.Z.Control,{type:"text",...register("expositor",{required:"Estecampo es requerido"})}),errors.expositor&&(0,jsx_runtime.jsx)(Form.Z.Text,{className:"text-danger",children:errors.expositor.message})]}),(0,jsx_runtime.jsxs)(Form.Z.Group,{className:"form-group mb-3",children:[(0,jsx_runtime.jsx)(Form.Z.Label,{style:{fontWeight:"bold"},children:"Sal\xf3n"}),(0,jsx_runtime.jsxs)(Form.Z.Select,{...register("salon",{required:"Este campo es requerido"}),onChange(event){setValue("salon",event.target.value),setSalonId(Number(event.target.value)),console.log("Sal\xf3n seleccionado:",event.target.value)},children:[(0,jsx_runtime.jsx)("option",{children:"Seleccionar"}),SalonConferencia.map(salon=>(console.log(salon),(0,jsx_runtime.jsx)("option",{value:salon.id,children:salon.attributes.nombre},salon.id)))]})]}),(0,jsx_runtime.jsxs)(Form.Z.Group,{className:"form-group mb-3",children:[(0,jsx_runtime.jsx)(Form.Z.Label,{style:{fontWeight:"bold"},children:"Fecha"}),(0,jsx_runtime.jsx)(react_datepicker_min_default(),{minDate:new Date,excludeDates:diasNoHabiles[salonId]||[],className:"date-picker",selected:selectedDate,onChange(date){console.log(date),setSelectedDate(date)},dateFormat:"dd/MM/yyyy"}),errors.fecha&&(0,jsx_runtime.jsx)(Form.Z.Text,{className:"text-danger",children:errors.fecha.message})]}),(0,jsx_runtime.jsxs)(Form.Z.Group,{className:"mb-3",children:[(0,jsx_runtime.jsx)(Form.Z.Label,{style:{fontWeight:"bold"},children:"Hora"}),(0,jsx_runtime.jsxs)("select",{style:{borderColor:"green"},...register("hora",{required:"Este campo es requerido"}),children:[(0,jsx_runtime.jsx)("option",{value:"",disabled:!0,children:"Seleccionar"}),[{horaLabel:"2:00 PM",horaValue:"02:00:00.000"},{horaLabel:"3:00 PM",horaValue:"03:00:00.000"},{horaLabel:"4:00 PM",horaValue:"04:00:00.000"},{horaLabel:"5:00 PM",horaValue:"05:00:00.000"},{horaLabel:"6:00 PM",horaValue:"06:00:00.000"},{horaLabel:"7:00 PM",horaValue:"07:00:00.000"},{horaLabel:"8:00 PM",horaValue:"08:00:00.000"},{horaLabel:"9:00 PM",horaValue:"09:00:00.000"}].map((hora,index)=>(0,jsx_runtime.jsx)("option",{value:hora.horaValue,children:hora.horaLabel},index))]}),errors.hora&&(0,jsx_runtime.jsx)(Form.Z.Text,{className:"text-danger",children:errors.hora.message})]}),(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{}),(0,jsx_runtime.jsx)(Button.Z,{type:"submit",variant:"success",children:"ENVIAR"})]})]})]})})};var solicitar_conferencia=NewCatalog}},function(__webpack_require__){__webpack_require__.O(0,[222,536,676,960,776,774,888,179],function(){return __webpack_require__(__webpack_require__.s=7043)}),_N_E=__webpack_require__.O()}]);