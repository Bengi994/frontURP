(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[557],{3419:function(__unused_webpack_module,__unused_webpack_exports,__webpack_require__){(window.__NEXT_P=window.__NEXT_P||[]).push(["/olvidaste-contrasena",function(){return __webpack_require__(8450)}])},5956:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{m:function(){return useRegister}});var _utils_api__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2400);let useRegister=()=>{let createClient=async data=>{var ref;let response=await _utils_api__WEBPACK_IMPORTED_MODULE_0__.h.post("/auth/local/register",{...data,username:data.email,role:{id:3}}).catch(response=>response.response);if(null===(ref=response.data)||void 0===ref?void 0:ref.error){let{message}=response.data.error;if(message.includes("already taken"))return alert("El email ya se encuentra registrado"),!1;let{details:{errors}}=response.data.error;for(let{path,message:message1}of errors)path.includes("dni")&&message1.includes("unique")&&alert("Este DNI ya se encuentra registrado por otro usuario");return!1}let{jwt,user}=response.data;return localStorage.setItem("token",jwt),localStorage.setItem("user",JSON.stringify(user)),user},forgotPassword=async email=>{let{data}=await _utils_api__WEBPACK_IMPORTED_MODULE_0__.h.post("/auth/forgot-password",{email}),{ok}=data;return ok?data.resetPasswordToken:"Algo salio mal"},resetPassword=async reset=>{let response=await _utils_api__WEBPACK_IMPORTED_MODULE_0__.h.post("/auth/reset-password",reset);return 200===response.status};return{createClient,forgotPassword,resetPassword}}},8450:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5893),_components_ResponsivePage__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(8776),react_bootstrap__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(1676),react_bootstrap__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(5005),react_hook_form__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(7536),_hookform_resolvers_yup__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(7533),yup__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(4231),_hooks_register_useRegister__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(5956),next_router__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(1163);let forgotPasswordSchema=yup__WEBPACK_IMPORTED_MODULE_2__.Ry({email:yup__WEBPACK_IMPORTED_MODULE_2__.Z_().required("El email es requerido").email("EL email tiene que tener el siguiente formato ejemplo@ejemplo.com")}).required(),OlvidasteContrasena=()=>{let{register,handleSubmit,formState:{errors}}=(0,react_hook_form__WEBPACK_IMPORTED_MODULE_5__.cI)({resolver:(0,_hookform_resolvers_yup__WEBPACK_IMPORTED_MODULE_6__.X)(forgotPasswordSchema)}),{forgotPassword}=(0,_hooks_register_useRegister__WEBPACK_IMPORTED_MODULE_3__.m)(),router=(0,next_router__WEBPACK_IMPORTED_MODULE_4__.useRouter)(),handleOnSubmit=async param=>{let{email}=param,result=await forgotPassword(email);if(result.includes("mal")){alert("No tenemos este email registrado");return}await router.push({pathname:"/restablecer-contrasena",query:{code:result}})};return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ResponsivePage__WEBPACK_IMPORTED_MODULE_1__.Y,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"container",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"d-flex flex-column justify-content-center align-items-center",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h1",{children:"Olvidaste tu contrase\xf1a?"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_bootstrap__WEBPACK_IMPORTED_MODULE_7__.Z,{onSubmit:handleSubmit(handleOnSubmit),children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(react_bootstrap__WEBPACK_IMPORTED_MODULE_7__.Z.Group,{className:"mb-3",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_7__.Z.Label,{children:"Email"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_7__.Z.Control,{type:"email",...register("email")}),errors.email&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_7__.Z.Text,{className:"text-danger",children:errors.email.message})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_bootstrap__WEBPACK_IMPORTED_MODULE_8__.Z,{variant:"primary",type:"submit",children:"Enviar correo"})]})]})})})};__webpack_exports__.default=OlvidasteContrasena}},function(__webpack_require__){__webpack_require__.O(0,[222,536,676,491,776,774,888,179],function(){return __webpack_require__(__webpack_require__.s=3419)}),_N_E=__webpack_require__.O()}]);