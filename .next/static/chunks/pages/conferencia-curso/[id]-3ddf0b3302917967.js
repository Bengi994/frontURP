(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[249],{2477:function(__unused_webpack_module,__unused_webpack_exports,__webpack_require__){(window.__NEXT_P=window.__NEXT_P||[]).push(["/conferencia-curso/[id]",function(){return __webpack_require__(4796)}])},8114:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{r:function(){return useCatalog}});var _utils_api__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2400);let useCatalog=()=>{let createCatalog=async(catalog,studentInfo)=>{let{data:{data:dataRaw}}=await _utils_api__WEBPACK_IMPORTED_MODULE_0__.h.post("/catologos",{data:catalog});return{...dataRaw.attributes,id:dataRaw.id}},getCatalogId=async catalogId=>{let response=await _utils_api__WEBPACK_IMPORTED_MODULE_0__.h.get("/catologos/".concat(catalogId)),catalogData=response.data.data.attributes;return catalogData},updateCatalog=async(catalogId,updatedCatalog)=>{let response=await _utils_api__WEBPACK_IMPORTED_MODULE_0__.h.put("/catologos/".concat(catalogId),{data:updatedCatalog});return 200===response.status?updatedCatalog:null},uploadPhoto=async(files,refId)=>{let formData=new FormData;formData.append("files",files),formData.append("ref","api::catologo.catologo"),formData.append("refId",refId),formData.append("field","foto");let response=await _utils_api__WEBPACK_IMPORTED_MODULE_0__.h.post("/upload",formData,{headers:{"content-type":"multipart/form-data"}});return 200===response.status};return{createCatalog,uploadPhoto,updateCatalog,getCatalogId}}},4796:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5893),_components_ResponsivePage__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(8776),react_qr_reader__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(7283),react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(7294),next_router__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(1163),_hooks_catalog_useCatalog__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(8114);let VerCatalogo=()=>{let router=(0,next_router__WEBPACK_IMPORTED_MODULE_4__.useRouter)(),{getCatalogId,updateCatalog}=(0,_hooks_catalog_useCatalog__WEBPACK_IMPORTED_MODULE_5__.r)(),[catalogo,setCatalogo]=(0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(null),[showQr,setshowQr]=(0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(!0),actualizar=(0,react__WEBPACK_IMPORTED_MODULE_3__.useCallback)(async(inscripciones,catalogId)=>{await updateCatalog(catalogId,{inscripciones}),setshowQr(!0)},[updateCatalog]),handleScan=(0,react__WEBPACK_IMPORTED_MODULE_3__.useCallback)((codigo,catalog,catalogId)=>{alert(codigo);let estaInscrito=catalog.inscripciones.some(catalogo=>catalogo.codigo===codigo),asistido=catalog.inscripciones.some(catalogo=>catalogo.codigo===codigo&&"Si"===catalogo.asistencia);if(!estaInscrito){alert("Usted No esta Inscrito en esta conferencia");return}if(asistido){alert("Ya marc\xf3 asistencia");return}setshowQr(!1);let inscripciones=catalog.inscripciones.map(catalogo=>(catalogo.codigo===codigo&&(catalogo.asistencia="Si"),catalogo));actualizar(inscripciones,catalogId)},[]);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_components_ResponsivePage__WEBPACK_IMPORTED_MODULE_1__.Y,{children:showQr&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_qr_reader__WEBPACK_IMPORTED_MODULE_2__.T,{constraints:{facingMode:"environment"},async onResult(result,error){if(result){let catalogId=router.query.id;if(catalogId&&"string"==typeof catalogId&&showQr){let catalogo=await getCatalogId(catalogId);console.log(catalogo),handleScan(null==result?void 0:result.text,catalogo,catalogId)}}error&&console.info(error)}})})};__webpack_exports__.default=VerCatalogo}},function(__webpack_require__){__webpack_require__.O(0,[738,222,776,774,888,179],function(){return __webpack_require__(__webpack_require__.s=2477)}),_N_E=__webpack_require__.O()}]);