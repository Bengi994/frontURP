"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[612],{7169:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5893),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(7294),_hooks_catalog_useCatalog__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(8114),react_hook_form__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(7536),_ResponsivePage_context__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(2698),_hooks_catalog_useCatalogs__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(9086),_hooks_user_useUsers__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(1662),axios__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(5121);let ModalInscribir=param=>{var ref,ref1,ref2,ref3;let{estado,cambiarEstado,catalogo,setCatalogo,estadoModalQR,cambiarEstadoQR}=param,{user}=(0,_ResponsivePage_context__WEBPACK_IMPORTED_MODULE_3__.XG)(),{updateUser}=(0,_hooks_user_useUsers__WEBPACK_IMPORTED_MODULE_5__.U)(),{register,handleSubmit,formState:{errors}}=(0,react_hook_form__WEBPACK_IMPORTED_MODULE_6__.cI)(),[estadoModal,cambiarEstadoModal]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!1),{updateCatalog}=(0,_hooks_catalog_useCatalog__WEBPACK_IMPORTED_MODULE_2__.r)(),{catalogs,myCatalog}=(0,_hooks_catalog_useCatalogs__WEBPACK_IMPORTED_MODULE_4__.$)(),[fotoUrl,setFotoUrl]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)();(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{let fetchData=async()=>{try{let apiFoto=await axios__WEBPACK_IMPORTED_MODULE_7__.Z.get("https://shrieking-web-97943-0c89be05ca8d.herokuapp.com/api/catologos/".concat(catalogo.id,"?populate=foto"));setFotoUrl(apiFoto.data.data.attributes.foto),console.log(fotoUrl)}catch(error){console.error("Error al obtener la foto:",error)}};fetchData()},[catalogo.id]);let handleOnSubmit=async data=>{var listaDeAlumnos;let flag,nuevoAlumno={nombre:null==user?void 0:user.nombre,apellido:null==user?void 0:user.apellido,codigo:null==user?void 0:user.codigo,carrera:null==user?void 0:user.escuela,asistencia:"No"};listaDeAlumnos=null!=catalogo.inscripciones?catalogo.inscripciones:[],flag=!1,(null==listaDeAlumnos?void 0:listaDeAlumnos.length)==0?listaDeAlumnos.push(nuevoAlumno):(listaDeAlumnos.forEach(alumno=>{alumno.codigo!=nuevoAlumno.codigo?flag=!0:console.log("El alumno ya se inscrbio")}),!0==flag&&listaDeAlumnos.push(nuevoAlumno));let response=await updateCatalog(catalogo.id,{inscripciones:listaDeAlumnos});response?(console.log("Nuevo alumno registrado con \xe9xito:",response),cambiarEstadoQR(!estadoModalQR)):console.error("Error al registrar al nuevo alumno."),cambiarEstado(!estado)},fechaFormateada=function(fechaOriginal){let fecha=new Date(fechaOriginal);fecha.setDate(fecha.getDate()+1);let dia=fecha.getDate(),mes=fecha.toLocaleDateString("es-ES",{month:"long"});return fecha.getFullYear(),"".concat(dia," de ").concat(mes)}(Date.parse(null==catalogo?void 0:catalogo.fecha));return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:estado&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"overlay",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"contenido-modal",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"encabezado-modal",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h3",{children:"INSCR\xcdBETE AHORA"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{className:"boton-cerrar",onClick:()=>cambiarEstado(!1),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("img",{src:"\\close-solid.svg",alt:"close"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"contenido",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"seccion",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h5",{children:"Conferencia: "}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{children:catalogo.tema_conferencia})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"seccion",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h5",{children:"Fecha y hora: "}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("p",{children:[null===fechaFormateada?"No establecida":fechaFormateada," - ",null===catalogo.hora?"No establecida":catalogo.hora.slice(0,5)]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"seccion",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h5",{children:"Sal\xf3n: "}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{children:(null===(ref=catalogo.salon.data)||void 0===ref?void 0:null===(ref1=ref.attributes)||void 0===ref1?void 0:ref1.nombre)===null?"No establecido":null===(ref2=catalogo.salon.data)||void 0===ref2?void 0:null===(ref3=ref2.attributes)||void 0===ref3?void 0:ref3.nombre})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"seccion",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h5",{children:"Dirigido a: "}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{children:null===catalogo.dirigido?"No establecido":catalogo.dirigido})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"seccion-titulo-alumno",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h3",{children:"Informaci\xf3n del alumno"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"seccion",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h5",{children:"C\xf3digo: "}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{children:null==user?void 0:user.codigo})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"seccion",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h5",{children:"Escuela: "}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{children:null==user?void 0:user.escuela})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"seccion",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h5",{children:"Nombres: "}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{children:null==user?void 0:user.nombre})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"seccion",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h5",{children:"Apellidos: "}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{children:null==user?void 0:user.apellido})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"seccion-botones",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"botones-modal",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{className:"inscribirme-ahora",onClick:handleSubmit(handleOnSubmit),children:"INSCRIBIRME AHORA"})})})]})]})})})};__webpack_exports__.Z=ModalInscribir},7655:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5893),_ResponsivePage_context__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2698);__webpack_require__(7294);var react_qr_code__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1653);let ModalQR=param=>{let{estado,cambiarEstado}=param,{user}=(0,_ResponsivePage_context__WEBPACK_IMPORTED_MODULE_1__.XG)();return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment,{children:estado&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"overlay",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"contenido-modal",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"encabezado-modal",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("h3",{children:"INSCRIPCI\xd3N CORRECTA"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{className:"boton-cerrar",onClick(){cambiarEstado(!1)},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("img",{src:"\\close-solid.svg",alt:"close"})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"contenedorQR",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("br",{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("br",{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(react_qr_code__WEBPACK_IMPORTED_MODULE_3__.ZP,{className:"codigoQR",value:(null==user?void 0:user.codigo)||"",viewBox:"0 0 256 256",fgColor:"black"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("br",{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("br",{}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("br",{})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("p",{className:"textoQR",children:"Se ha registrado correctamente a la conferencia, por favor, guarde su pase QR con el bot\xf3n de abajo o con una captura de pantalla, ser\xe1 necesario para el ingreso a la conferencia."}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("button",{className:"inscribirme-ahora",style:{display:"flex",justifyContent:"center"},children:"Descargar QR"})]})})})};__webpack_exports__.Z=ModalQR},8114:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{r:function(){return useCatalog}});var _utils_api__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2400);let useCatalog=()=>{let createCatalog=async(catalog,studentInfo)=>{let{data:{data:dataRaw}}=await _utils_api__WEBPACK_IMPORTED_MODULE_0__.h.post("/catologos",{data:catalog});return{...dataRaw.attributes,id:dataRaw.id}},getCatalogId=async catalogId=>{let response=await _utils_api__WEBPACK_IMPORTED_MODULE_0__.h.get("/catologos/".concat(catalogId)),catalogData=response.data.data.attributes;return catalogData},updateCatalog=async(catalogId,updatedCatalog)=>{let response=await _utils_api__WEBPACK_IMPORTED_MODULE_0__.h.put("/catologos/".concat(catalogId),{data:updatedCatalog});return 200===response.status?updatedCatalog:null},uploadPhoto=async(files,refId)=>{let formData=new FormData;formData.append("files",files),formData.append("ref","api::catologo.catologo"),formData.append("refId",refId),formData.append("field","foto");let response=await _utils_api__WEBPACK_IMPORTED_MODULE_0__.h.post("/upload",formData,{headers:{"content-type":"multipart/form-data"}});return 200===response.status};return{createCatalog,uploadPhoto,updateCatalog,getCatalogId}}},9086:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{$:function(){return useCatalogs}});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(7294),_utils_api__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2400);let useCatalogs=()=>{let[catalogs,setCatalogs]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)([]),[SalonConferencia,setSalonConferencia]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)([]),getSalonNombre=salonId=>{let salon=SalonConferencia.find(salon=>salon.id===salonId);return salon?salon.attributes.nombre:""},getCatalogs=async()=>{let{data:{data:dataRaw}}=await _utils_api__WEBPACK_IMPORTED_MODULE_1__.h.get("/catologos?populate=*"),catalogsMapping=dataRaw.map(param=>{let{id,attributes}=param;return{...attributes,id}});setCatalogs(catalogsMapping)},removeCatalog=async catalogId=>{await _utils_api__WEBPACK_IMPORTED_MODULE_1__.h.put("/catologos/".concat(catalogId),{data:{disponible:!1,miconf:!1}}),await getCatalogs()},enabledCatalog=async catalogId=>{await _utils_api__WEBPACK_IMPORTED_MODULE_1__.h.put("/catologos/".concat(catalogId),{data:{disponible:!0,miconf:!1}}),await getCatalogs()},myCatalog=async catalogId=>{await _utils_api__WEBPACK_IMPORTED_MODULE_1__.h.put("/catologos/".concat(catalogId),{data:{disponible:!0,miconf:!0}}),await getCatalogs()},getCatalogId=async catalogId=>{let response=await _utils_api__WEBPACK_IMPORTED_MODULE_1__.h.get("/catologos/".concat(catalogId)),catalogData=response.data.data.attributes;return catalogData};return(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(()=>{getCatalogs()},[]),{catalogs,removeCatalog,enabledCatalog,myCatalog,getCatalogId,getSalonNombre}}},1662:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{U:function(){return useUsers}});var _utils_api__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2400),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(7294);let useUsers=()=>{let[users,setUsers]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]),createUser=async data=>{var ref;let response=await _utils_api__WEBPACK_IMPORTED_MODULE_0__.h.post("/auth/local/register",{...data,username:data.email}).catch(response=>response.response);if(null===(ref=response.data)||void 0===ref?void 0:ref.error){let{details:{errors}}=response.data.error;for(let{path,message}of errors)path.includes("dni")&&message.includes("unique")&&alert("Este DNI ya se encuentra registrado por otro usuario");return!1}return await getUsers(),200===response.status},updateUser=async data=>{var ref;let response=await _utils_api__WEBPACK_IMPORTED_MODULE_0__.h.put("/users/".concat(data.id),{nombre:data.nombre,apellido:data.apellido,dni:data.dni,email:data.email,username:data.email,...data.password&&{password:data.password},rol:{id:data.role.id},conferencias:data.conferencias}).catch(response=>response.response);if(null===(ref=response.data)||void 0===ref?void 0:ref.error){let{details:{errors}}=response.data.error;for(let{path,message}of errors)path.includes("dni")&&message.includes("unique")&&alert("Este DNI ya se encuentra registrado por otro usuario");return!1}return await getUsers(),200===response.status},removeUser=async userId=>{let response=await _utils_api__WEBPACK_IMPORTED_MODULE_0__.h.put("/users/".concat(userId),{blocked:!0});return await getUsers(),200===response.status},enableUser=async userId=>{let response=await _utils_api__WEBPACK_IMPORTED_MODULE_0__.h.put("/users/".concat(userId),{blocked:!1});return await getUsers(),200===response.status},getUsers=async()=>{let{data}=await _utils_api__WEBPACK_IMPORTED_MODULE_0__.h.get("/users");setUsers(data)};return(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{getUsers()},[]),{users,createUser,updateUser,removeUser,enableUser}}}}]);